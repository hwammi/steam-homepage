<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>실험 데이터 — STEAM Project Hub</title>
  <meta name="description" content="AFM, TEM, SEM, TEY, XPS, XRD, STXM, PXM, FIB-SEM Tomography, EIS 등 실험 데이터셋 선택 페이지 (정적 파일 다운로드)" />
  <style>
    :root{
      --bg:#0b0d12; --fg:#e8ecf3; --muted:#a5afc2; --card:#12161f; --border:#1c2230;
      --accent:#7c9cff; --accent2:#00d1b2; --shadow:0 10px 30px rgba(0,0,0,.35); --r:18px;
      --pop-dur:.8s; --pop-ease:cubic-bezier(.16,1,.3,1); --pop-scale:1.03;
      --overlay-dur:.5s; --modal-dur:.55s; --modal-ease:cubic-bezier(.16,1,.3,1);
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#f7f9fc; --fg:#0d1117; --muted:#536075; --card:#ffffff; --border:#e6eaf1; --accent:#3b82f6; --accent2:#14b8a6; }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--fg); font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Arial}
    a{color:inherit; text-decoration:none}
    .container{width:min(100%,1100px); margin:0 auto; padding:24px 20px}
    header{position:sticky; top:0; z-index:10; backdrop-filter:saturate(120%) blur(8px); background:color-mix(in srgb,var(--bg),transparent 20%); border-bottom:1px solid var(--border)}
    .nav{display:flex; align-items:center; justify-content:space-between; height:64px}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800}
    .mark{width:28px; height:28px; border-radius:8px; background:linear-gradient(135deg,var(--accent),var(--accent2))}

    .hero{padding:28px 0}
    .hero h1{margin:0 0 6px; font-size:clamp(22px,4.5vw,36px); line-height:1.15}
    .hero p{margin:0; color:var(--muted)}
    .crumbs{display:flex; gap:8px; align-items:center; font-size:14px; color:var(--muted)}
    .crumbs a{color:var(--muted)}

    /* rows: 4 + 4 + 2 */
    .row{display:grid; gap:20px; grid-template-columns:1fr; margin-top:22px}
    @media (min-width:900px){ .row.cols-4{grid-template-columns:repeat(4,1fr)} .row.cols-2{grid-template-columns:repeat(2,1fr)} }

    .card{position:relative; background:var(--card); border:1px solid var(--border); border-radius:var(--r); padding:16px; box-shadow:var(--shadow);
      transition:transform var(--pop-dur) var(--pop-ease), box-shadow var(--pop-dur) var(--pop-ease), filter var(--pop-dur) ease}
    .card:hover,.card:focus-within{transform:translateY(-6px) scale(var(--pop-scale)); box-shadow:0 20px 50px rgba(0,0,0,.5); filter:brightness(1.02)}
    .card .uploader{position:absolute; right:12px; top:12px}

    figure{margin:0; border:1px dashed var(--border); border-radius:14px; overflow:hidden; background:color-mix(in srgb,var(--card),transparent 40%);}
    .preview{width:100%; aspect-ratio:16/9; object-fit:cover; display:block}
    figcaption{font-weight:800; text-align:center; margin-top:10px}

    /* 대표 이미지 업로더(미리보기용) */
    .uploader input{display:none}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:10px; border:1px solid var(--border); cursor:pointer; background:rgba(255,255,255,.03)}

    footer{padding:40px 0 60px; color:var(--muted)}

    /* ===== Modal (popup) ===== */
    .modal{position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,0); opacity:0; pointer-events:none; transition:background var(--overlay-dur) ease, opacity var(--overlay-dur) ease}
    .modal.open{background:rgba(0,0,0,.45); opacity:1; pointer-events:auto}
    .panel{width:min(96vw, 980px); max-height:90vh; background:var(--card); border:1px solid var(--border); border-radius:20px; box-shadow:0 30px 90px rgba(0,0,0,.6);
      transform:translateY(18px) scale(.98); opacity:.98; transition:transform var(--modal-dur) var(--modal-ease), opacity var(--modal-dur) var(--modal-ease)}
    .modal.open .panel{transform:translateY(0) scale(1); opacity:1}
    .panel header{display:flex; justify-content:space-between; align-items:center; padding:16px 18px; border-bottom:1px solid var(--border)}
    .panel header h2{margin:0; font-size:20px}
    .close{border:1px solid var(--border); background:transparent; color:var(--fg); border-radius:10px; padding:6px 10px; cursor:pointer}
    .panel .inner{display:grid; grid-template-columns:1fr; gap:18px; padding:18px}
    @media (min-width:900px){ .panel .inner{grid-template-columns:1.2fr 1fr} }
    .bigpreview{border:1px dashed var(--border); border-radius:14px; overflow:hidden; display:grid; place-items:center; background:color-mix(in srgb,var(--card),transparent 40%)}
    .bigpreview img{max-width:100%; height:auto; display:block}

    .attachments h3{margin:0 0 8px}
    .chips{display:grid; gap:10px}
    .chip{display:flex; justify-content:space-between; align-items:center; gap:10px; border:1px solid var(--border); border-radius:12px; padding:10px 12px}
    .chip a{font-weight:700}
    .empty{color:var(--muted); font-size:14px}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><span class="mark" aria-hidden="true"></span> STEAM Project Hub</div>
      <nav aria-label="보조">
        <a href="database.html" style="font-size:14px; color:var(--muted)">← 데이터베이스</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="crumbs"><a href="index.html">홈</a> › <a href="database.html">데이터베이스</a> › <span>실험 데이터</span></div>
    <section class="hero" aria-label="타이틀">
      <h1>실험 데이터 (총 10개)</h1>
      <p>블록을 클릭하면 같은 화면에서 팝업이 열리고, <strong>사전에 업로드해 둔 데이터셋</strong>을 다운로드할 수 있습니다.</p>
    </section>

    <!-- Row 1: 4 items -->
    <section class="row cols-4" aria-label="Row 1">
      <article class="card" data-id="afm" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="afmImg">대표 이미지</label><input id="afmImg" type="file" accept="image/*"></div>
        <figure>
          <img id="afmPreview" class="preview" alt="AFM 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>AFM (Atomic Force Microscopy)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="tem" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="temImg">대표 이미지</label><input id="temImg" type="file" accept="image/*"></div>
        <figure>
          <img id="temPreview" class="preview" alt="TEM 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>TEM (Transmission Electron Microscopy)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="sem" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="semImg">대표 이미지</label><input id="semImg" type="file" accept="image/*"></div>
        <figure>
          <img id="semPreview" class="preview" alt="SEM 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>SEM (Scanning Electron Microscopy)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="tey" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="teyImg">대표 이미지</label><input id="teyImg" type="file" accept="image/*"></div>
        <figure>
          <img id="teyPreview" class="preview" alt="TEY 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>TEY (Total Electron Yield)</figcaption>
        </figure>
      </article>
    </section>

    <!-- Row 2: 4 items -->
    <section class="row cols-4" aria-label="Row 2">
      <article class="card" data-id="xps" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="xpsImg">대표 이미지</label><input id="xpsImg" type="file" accept="image/*"></div>
        <figure>
          <img id="xpsPreview" class="preview" alt="XPS 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>XPS (X-ray Photoelectron Spectroscopy)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="xrd" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="xrdImg">대표 이미지</label><input id="xrdImg" type="file" accept="image/*"></div>
        <figure>
          <img id="xrdPreview" class="preview" alt="XRD 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>XRD (X-ray Diffraction)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="stxm" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="stxmImg">대표 이미지</label><input id="stxmImg" type="file" accept="image/*"></div>
        <figure>
          <img id="stxmPreview" class="preview" alt="STXM 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>STXM (Scanning Transmission X-ray Microscopy)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="pxm" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="pxmImg">대표 이미지</label><input id="pxmImg" type="file" accept="image/*"></div>
        <figure>
          <img id="pxmPreview" class="preview" alt="PXM 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>PXM (Photoemission X-ray Microscopy)</figcaption>
        </figure>
      </article>
    </section>

    <!-- Row 3: 2 items -->
    <section class="row cols-2" aria-label="Row 3">
      <article class="card" data-id="fibsem" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="fibsemImg">대표 이미지</label><input id="fibsemImg" type="file" accept="image/*"></div>
        <figure>
          <img id="fibsemPreview" class="preview" alt="FIB-SEM 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>FIB-SEM Tomography (Focused Ion Beam-SEM)</figcaption>
        </figure>
      </article>
      <article class="card" data-id="eis" role="button" tabindex="0">
        <div class="uploader"><label class="btn" for="eisImg">대표 이미지</label><input id="eisImg" type="file" accept="image/*"></div>
        <figure>
          <img id="eisPreview" class="preview" alt="EIS 미리보기" src="data:image/svg+xml;utf8,<?xml version='1.0'?><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'><rect width='800' height='450' rx='20' fill='%2312161f'/><rect x='28' y='28' width='744' height='394' rx='12' fill='%231b2030'/></svg>" />
          <figcaption>EIS (Electrochemical Impedance Spectroscopy)</figcaption>
        </figure>
      </article>
    </section>
  </main>

  <footer>
    <div class="container" style="display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap">
      <div class="brand"><span class="mark" aria-hidden="true"></span> <strong>STEAM Project Hub</strong></div>
      <div>© <span id="y"></span> STEAM Project Hub</div>
    </div>
  </footer>

  <!-- Modal for attachments -->
  <div class="modal" id="datasetModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" hidden>
    <div class="panel">
      <header>
        <h2 id="modalTitle">데이터셋</h2>
        <button class="close" id="closeModal" aria-label="닫기">닫기</button>
      </header>
      <div class="inner">
        <div class="bigpreview"><img id="modalImg" alt="선택한 데이터셋 미리보기"></div>
        <div class="attachments">
          <h3>첨부된 데이터셋</h3>
          <div class="chips" id="attachList"><div class="empty">아직 첨부된 파일이 없습니다.</div></div>
          <p class="empty" style="margin-top:8px">* 관리자가 <code>docs/datasets/</code> 폴더에 올린 파일만 보입니다.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // 대표 이미지 미리보기 연결 (페이지 내 미리보기용)
    function wirePreview(inputId, imgId){
      const input = document.getElementById(inputId);
      const img = document.getElementById(imgId);
      input.addEventListener('change', ()=>{
        const f = input.files && input.files[0];
        if(!f) return; img.src = URL.createObjectURL(f); img.alt = f.name;
      });
    }
    ['afm','tem','sem','tey','xps','xrd','stxm','pxm','fibsem','eis'].forEach(k=> wirePreview(k+'Img', k+'Preview'));

    // ===== 정적 데이터셋 매핑 =====
    // docs/ 루트 기준 상대경로. 예: docs/datasets/AFM.xlsx
    // 필요에 따라 각 항목 files 배열에 파일을 추가하세요.
    const DATASETS = {
      afm:   { name: 'AFM (Atomic Force Microscopy)', files: [
        { name: 'AFM.xlsx', url: 'datasets/AFM.xlsx' } // 예시: 이미 올려두신 파일
        // { name: 'AFM_raw.csv', url: 'datasets/AFM_raw.csv' },
      ]},
      tem:   { name: 'TEM (Transmission Electron Microscopy)', files: [] },
      sem:   { name: 'SEM (Scanning Electron Microscopy)', files: [] },
      tey:   { name: 'TEY (Total Electron Yield)', files: [] },
      xps:   { name: 'XPS (X-ray Photoelectron Spectroscopy)', files: [] },
      xrd:   { name: 'XRD (X-ray Diffraction)', files: [] },
      stxm:  { name: 'STXM (Scanning Transmission X-ray Microscopy)', files: [] },
      pxm:   { name: 'PXM (Photoemission X-ray Microscopy)', files: [] },
      fibsem:{ name: 'FIB-SEM Tomography (Focused Ion Beam-SEM)', files: [] },
      eis:   { name: 'EIS (Electrochemical Impedance Spectroscopy)', files: [] }
    };

    // ===== Modal 로직 =====
    const modal = document.getElementById('datasetModal');
    const closeBtn = document.getElementById('closeModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalImg = document.getElementById('modalImg');
    const attachList = document.getElementById('attachList');

    function openModal(id){
      const cardImg = document.getElementById(id+'Preview');
      modalImg.src = cardImg.src; modalImg.alt = DATASETS[id].name + ' 대표 이미지';
      modalTitle.textContent = DATASETS[id].name;
      renderList(id);
      modal.hidden = false; modal.classList.add('open');
      closeBtn.focus();
      document.addEventListener('keydown', escToClose);
    }
    function closeModal(){
      modal.classList.remove('open');
      modal.addEventListener('transitionend', ()=>{ modal.hidden = true; }, { once:true });
      document.removeEventListener('keydown', escToClose);
    }
    function escToClose(e){ if(e.key==='Escape') closeModal(); }
    modal.addEventListener('click', (e)=>{ if(e.target === modal) closeModal(); });
    closeBtn.addEventListener('click', closeModal);

    // 첨부 리스트 렌더링 (정적 파일만)
    function renderList(id){
      const files = (DATASETS[id] && DATASETS[id].files) || [];
      attachList.innerHTML = '';
      if(files.length === 0){
        const emp = document.createElement('div'); emp.className='empty';
        emp.textContent='아직 첨부된 파일이 없습니다.'; attachList.appendChild(emp); return;
      }
      files.forEach(f=>{
        const chip = document.createElement('div'); chip.className='chip';

        const left = document.createElement('div');
        const a = document.createElement('a');
        a.href = encodeURI(f.url); // 파일명에 공백/한글 대비
        a.download = f.name;
        a.textContent = f.name;
        a.rel = 'noopener';
        a.target = '_blank'; // 새 탭 열기 (뷰어나 다운로드)
        left.appendChild(a);

        const right = document.createElement('div');
        const dl = document.createElement('a');
        dl.href = encodeURI(f.url);
        dl.download = f.name;
        dl.textContent = '다운로드';
        dl.className = 'btn';
        right.appendChild(dl);

        chip.appendChild(left); chip.appendChild(right);
        attachList.appendChild(chip);
      });
    }

    // 카드 클릭 → 모달 오픈 (대표 이미지 업로더 클릭은 무시)
    document.querySelectorAll('.card').forEach(card=>{
      card.addEventListener('click', (e)=>{ if(e.target.closest('.uploader')) return; openModal(card.dataset.id); });
      card.addEventListener('keydown', (e)=>{ if(e.target.closest('.uploader')) return; if(e.key==='Enter'||e.key===' ') { e.preventDefault(); openModal(card.dataset.id); } });
    });
  </script>
</body>
</html>
